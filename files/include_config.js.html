<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>include\config.js - PencilBlue</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="http://pencilblue.org/img/pb_logo.png" title="PencilBlue"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.4.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/AdminChangePasswordController.html">AdminChangePasswordController</a></li>
            
                <li><a href="../classes/AdminIndexController.html">AdminIndexController</a></li>
            
                <li><a href="../classes/AdminNavigation.html">AdminNavigation</a></li>
            
                <li><a href="../classes/AdminSubnavService.html">AdminSubnavService</a></li>
            
                <li><a href="../classes/AnalyticsManager.html">AnalyticsManager</a></li>
            
                <li><a href="../classes/ApiActionController.html">ApiActionController</a></li>
            
                <li><a href="../classes/ArticleService.html">ArticleService</a></li>
            
                <li><a href="../classes/AsyncJobRunner.html">AsyncJobRunner</a></li>
            
                <li><a href="../classes/BaseBodyParser.html">BaseBodyParser</a></li>
            
                <li><a href="../classes/BaseController.html">BaseController</a></li>
            
                <li><a href="../classes/BaseMediaRenderer.html">BaseMediaRenderer</a></li>
            
                <li><a href="../classes/CacheEntityService.html">CacheEntityService</a></li>
            
                <li><a href="../classes/CacheFactory.html">CacheFactory</a></li>
            
                <li><a href="../classes/CallHomeService.html">CallHomeService</a></li>
            
                <li><a href="../classes/ChangePasswordFormController.html">ChangePasswordFormController</a></li>
            
                <li><a href="../classes/ClientJs.html">ClientJs</a></li>
            
                <li><a href="../classes/ClusterApiController.html">ClusterApiController</a></li>
            
                <li><a href="../classes/ClusterJobRunner.html">ClusterJobRunner</a></li>
            
                <li><a href="../classes/CommandService.html">CommandService</a></li>
            
                <li><a href="../classes/CommentService.html">CommentService</a></li>
            
                <li><a href="../classes/ContentService.html">ContentService</a></li>
            
                <li><a href="../classes/CustomObjectService.html">CustomObjectService</a></li>
            
                <li><a href="../classes/DailyMotionMediaRenderer.html">DailyMotionMediaRenderer</a></li>
            
                <li><a href="../classes/DAO.html">DAO</a></li>
            
                <li><a href="../classes/DbEntityService.html">DbEntityService</a></li>
            
                <li><a href="../classes/DBManager.html">DBManager</a></li>
            
                <li><a href="../classes/DeleteArticleActionController.html">DeleteArticleActionController</a></li>
            
                <li><a href="../classes/DeleteMediaController.html">DeleteMediaController</a></li>
            
                <li><a href="../classes/DocumentCreator.html">DocumentCreator</a></li>
            
                <li><a href="../classes/EditMediaActionController.html">EditMediaActionController</a></li>
            
                <li><a href="../classes/EditObject.html">EditObject</a></li>
            
                <li><a href="../classes/EditObjectType.html">EditObjectType</a></li>
            
                <li><a href="../classes/EmailService.html">EmailService</a></li>
            
                <li><a href="../classes/ErrorsOverTime.html">ErrorsOverTime</a></li>
            
                <li><a href="../classes/ForgotPasswordController.html">ForgotPasswordController</a></li>
            
                <li><a href="../classes/FormAuthentication.html">FormAuthentication</a></li>
            
                <li><a href="../classes/FormBodyParser.html">FormBodyParser</a></li>
            
                <li><a href="../classes/FormController.html">FormController</a></li>
            
                <li><a href="../classes/FSEntityService.html">FSEntityService</a></li>
            
                <li><a href="../classes/FsMediaProvider.html">FsMediaProvider</a></li>
            
                <li><a href="../classes/GetMediaEmbedApiController.html">GetMediaEmbedApiController</a></li>
            
                <li><a href="../classes/GetMediaLinkApiController.html">GetMediaLinkApiController</a></li>
            
                <li><a href="../classes/GetMediaPreviewApiController.html">GetMediaPreviewApiController</a></li>
            
                <li><a href="../classes/HomePageSettings.html">HomePageSettings</a></li>
            
                <li><a href="../classes/ImageMediaRenderer.html">ImageMediaRenderer</a></li>
            
                <li><a href="../classes/ImportTopics.html">ImportTopics</a></li>
            
                <li><a href="../classes/ImportWPActionController.html">ImportWPActionController</a></li>
            
                <li><a href="../classes/Index.html">Index</a></li>
            
                <li><a href="../classes/InstagramMediaRenderer.html">InstagramMediaRenderer</a></li>
            
                <li><a href="../classes/JobApiController.html">JobApiController</a></li>
            
                <li><a href="../classes/JobRunner.html">JobRunner</a></li>
            
                <li><a href="../classes/JobService.html">JobService</a></li>
            
                <li><a href="../classes/JsonBodyParser.html">JsonBodyParser</a></li>
            
                <li><a href="../classes/JSONFSEntityService.html">JSONFSEntityService</a></li>
            
                <li><a href="../classes/KickStarterMediaRenderer.html">KickStarterMediaRenderer</a></li>
            
                <li><a href="../classes/LibrariesService.html">LibrariesService</a></li>
            
                <li><a href="../classes/Localization.html">Localization</a></li>
            
                <li><a href="../classes/LocalizationApiController.html">LocalizationApiController</a></li>
            
                <li><a href="../classes/LoginActionController.html">LoginActionController</a></li>
            
                <li><a href="../classes/LoginViewController.html">LoginViewController</a></li>
            
                <li><a href="../classes/LogoutController.html">LogoutController</a></li>
            
                <li><a href="../classes/ManageComments.html">ManageComments</a></li>
            
                <li><a href="../classes/ManageObjects.html">ManageObjects</a></li>
            
                <li><a href="../classes/ManageObjectTypes.html">ManageObjectTypes</a></li>
            
                <li><a href="../classes/MediaContentController.html">MediaContentController</a></li>
            
                <li><a href="../classes/MediaForm.html">MediaForm</a></li>
            
                <li><a href="../classes/MediaLoader.html">MediaLoader</a></li>
            
                <li><a href="../classes/MediaService.html">MediaService</a></li>
            
                <li><a href="../classes/MemoryEntityService.html">MemoryEntityService</a></li>
            
                <li><a href="../classes/MongoCommandBroker.html">MongoCommandBroker</a></li>
            
                <li><a href="../classes/MongoMediaProvider.html">MongoMediaProvider</a></li>
            
                <li><a href="../classes/MongoRegistrationProvider.html">MongoRegistrationProvider</a></li>
            
                <li><a href="../classes/MongoSessionStore.html">MongoSessionStore</a></li>
            
                <li><a href="../classes/NavItemFormController.html">NavItemFormController</a></li>
            
                <li><a href="../classes/NewMediaApiController.html">NewMediaApiController</a></li>
            
                <li><a href="../classes/NewObjectActionController.html">NewObjectActionController</a></li>
            
                <li><a href="../classes/NewObjectTypeActionController.html">NewObjectTypeActionController</a></li>
            
                <li><a href="../classes/NewPagePostController.html">NewPagePostController</a></li>
            
                <li><a href="../classes/NotFoundController.html">NotFoundController</a></li>
            
                <li><a href="../classes/ObjectFormController.html">ObjectFormController</a></li>
            
                <li><a href="../classes/PageController.html">PageController</a></li>
            
                <li><a href="../classes/PBError.html">PBError</a></li>
            
                <li><a href="../classes/PencilBlue.html">PencilBlue</a></li>
            
                <li><a href="../classes/PluginApi.html">PluginApi</a></li>
            
                <li><a href="../classes/PluginAvailableJob.html">PluginAvailableJob</a></li>
            
                <li><a href="../classes/PluginDependenciesJob.html">PluginDependenciesJob</a></li>
            
                <li><a href="../classes/PluginDetailsViewController.html">PluginDetailsViewController</a></li>
            
                <li><a href="../classes/PluginInitializeJob.html">PluginInitializeJob</a></li>
            
                <li><a href="../classes/PluginInstallJob.html">PluginInstallJob</a></li>
            
                <li><a href="../classes/PluginJobRunner.html">PluginJobRunner</a></li>
            
                <li><a href="../classes/PluginPublicContentController.html">PluginPublicContentController</a></li>
            
                <li><a href="../classes/PluginService.html">PluginService</a></li>
            
                <li><a href="../classes/PluginSettingsFormController.html">PluginSettingsFormController</a></li>
            
                <li><a href="../classes/PluginUninstallJob.html">PluginUninstallJob</a></li>
            
                <li><a href="../classes/RandomTextViewController.html">RandomTextViewController</a></li>
            
                <li><a href="../classes/ReadOnlySimpleLayeredService.html">ReadOnlySimpleLayeredService</a></li>
            
                <li><a href="../classes/RedisCommandBroker.html">RedisCommandBroker</a></li>
            
                <li><a href="../classes/RedisRegistrationProvider.html">RedisRegistrationProvider</a></li>
            
                <li><a href="../classes/RedisSessionStore.html">RedisSessionStore</a></li>
            
                <li><a href="../classes/RequestHandler.html">RequestHandler</a></li>
            
                <li><a href="../classes/SaveHomePageSettings.html">SaveHomePageSettings</a></li>
            
                <li><a href="../classes/SectionService.html">SectionService</a></li>
            
                <li><a href="../classes/SecurityService.html">SecurityService</a></li>
            
                <li><a href="../classes/ServerRegistration.html">ServerRegistration</a></li>
            
                <li><a href="../classes/SessionHandler.html">SessionHandler</a></li>
            
                <li><a href="../classes/SettingsServiceFactory.html">SettingsServiceFactory</a></li>
            
                <li><a href="../classes/SetupActionController.html">SetupActionController</a></li>
            
                <li><a href="../classes/SetupViewController.html">SetupViewController</a></li>
            
                <li><a href="../classes/SimpleLayeredService.html">SimpleLayeredService</a></li>
            
                <li><a href="../classes/SlideShareMediaRenderer.html">SlideShareMediaRenderer</a></li>
            
                <li><a href="../classes/SortObjects.html">SortObjects</a></li>
            
                <li><a href="../classes/SortObjectsActionController.html">SortObjectsActionController</a></li>
            
                <li><a href="../classes/StorifyMediaRenderer.html">StorifyMediaRenderer</a></li>
            
                <li><a href="../classes/System.html">System</a></li>
            
                <li><a href="../classes/TemplateEntityService.html">TemplateEntityService</a></li>
            
                <li><a href="../classes/TemplateService.html">TemplateService</a></li>
            
                <li><a href="../classes/TemplateValue.html">TemplateValue</a></li>
            
                <li><a href="../classes/TextService.html">TextService</a></li>
            
                <li><a href="../classes/TopMenuService.html">TopMenuService</a></li>
            
                <li><a href="../classes/TrinketMediaRenderer.html">TrinketMediaRenderer</a></li>
            
                <li><a href="../classes/UploadMediaController.html">UploadMediaController</a></li>
            
                <li><a href="../classes/UrlApiController.html">UrlApiController</a></li>
            
                <li><a href="../classes/UrlService.html">UrlService</a></li>
            
                <li><a href="../classes/UsernamePasswordAuthentication.html">UsernamePasswordAuthentication</a></li>
            
                <li><a href="../classes/UserService.html">UserService</a></li>
            
                <li><a href="../classes/Util.html">Util</a></li>
            
                <li><a href="../classes/ValidationService.html">ValidationService</a></li>
            
                <li><a href="../classes/VideoMediaRenderer.html">VideoMediaRenderer</a></li>
            
                <li><a href="../classes/View Controller.html">View Controller</a></li>
            
                <li><a href="../classes/VimeoMediaRenderer.html">VimeoMediaRenderer</a></li>
            
                <li><a href="../classes/VineMediaRenderer.html">VineMediaRenderer</a></li>
            
                <li><a href="../classes/WPXMLParseService.html">WPXMLParseService</a></li>
            
                <li><a href="../classes/YouTubeMediaRenderer.html">YouTubeMediaRenderer</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/Admin.html">Admin</a></li>
            
                <li><a href="../modules/dao.html">dao</a></li>
            
                <li><a href="../modules/Database.html">Database</a></li>
            
                <li><a href="../modules/Entities.html">Entities</a></li>
            
                <li><a href="../modules/ErrorSuccess.html">ErrorSuccess</a></li>
            
                <li><a href="../modules/Model.html">Model</a></li>
            
                <li><a href="../modules/Security.html">Security</a></li>
            
                <li><a href="../modules/Services.html">Services</a></li>
            
                <li><a href="../modules/Session.html">Session</a></li>
            
                <li><a href="../modules/Storage.html">Storage</a></li>
            
                <li><a href="../modules/Theme.html">Theme</a></li>
            
                <li><a href="../modules/Validation.html">Validation</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: include\config.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/*
    Copyright (C) 2015  PencilBlue, LLC

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.
*/

//dependencies
var fs      = require(&#x27;fs&#x27;);
var path    = require(&#x27;path&#x27;);
var cluster = require(&#x27;cluster&#x27;);
var process = require(&#x27;process&#x27;);
var util    = require(&#x27;./util.js&#x27;);
var process = require(&#x27;process&#x27;);
var winston = require(&#x27;winston&#x27;);

/**
 * Default configuration.  The settings here should be overriden by taking the
 * example file &quot;sample.config.json&quot; and modifying it to override the properties
 * shown below.  In order to properly override the default configuration do the
 * following:
 * 1) copy &quot;sample.config.json&quot; to &quot;/etc/pencilblue/config.json&quot;
 * 2) Override the properties as desired.
 * 3) Add any custom properties you wish to provide for your specific purposes.
 */
function Configuration(){}

/**
 * 
 * @static
 * @readonly
 * @property DOCUMENT_ROOT
 * @type {String}
 */
Configuration.DOCUMENT_ROOT = __dirname.substr(0, __dirname.indexOf(path.sep+&#x27;include&#x27;));

/**
 * 
 * @static
 * @readonly
 * @property EXTERNAL_ROOT
 * @type {String}
 */
Configuration.EXTERNAL_ROOT = path.join(path.sep, &#x27;etc&#x27;, &#x27;pencilblue&#x27;);

/**
 * Ascending index value
 * @private
 * @static
 * @readonly
 * @property ASC
 * @type {Integer}
 */
var ASC  = 1;

/**
 * Descending index value
 * @private
 * @static
 * @readonly
 * @property DESC
 * @type {Integer}
 */
var DESC = -1;

/**
 * The default logging directory absolute file path
 * @private
 * @static
 * @readonly
 * @property LOG_DIR
 * @type {String}
 */
var LOG_DIR = path.join(Configuration.DOCUMENT_ROOT, &#x27;log&#x27;);

/**
 * The default logging file absolute path
 * @private
 * @static
 * @readonly
 * @property LOG_FILESC
 * @type {String}
 */
var LOG_FILE = path.join(LOG_DIR, &#x27;pencilblue.log&#x27;);

/**
 * The configuration module overrides file name 
 * @private
 * @static
 * @readonly
 * @property CONFIG_MODULE_NAME
 * @type {String}
 */
var CONFIG_MODULE_NAME  = &#x27;config.js&#x27;;

/**
 * The default list of absolute file paths to try when loading the configuration
 * @private
 * @static
 * @readonly
 * @property OVERRIDE_FILE_PATHS
 * @type {Array}
 */
var OVERRIDE_FILE_PATHS = [
    path.join(Configuration.DOCUMENT_ROOT, CONFIG_MODULE_NAME),
    path.join(Configuration.EXTERNAL_ROOT, CONFIG_MODULE_NAME),
];

/**
 * @private
 * @static
 * @readonly
 * @property BASE_CONFIG
 */
var BASE_CONFIG = {

    //The name of the site.
	siteName: &#x27;pencilblue&#x27;,

    //The root of the site.  This host part should ALWAYS match the value of
    //the siteIP
	siteRoot: &#x27;http://localhost:8080&#x27;,

    //The hostname or IP address that the web server instance will bind to
	siteIP:   &#x27;0.0.0.0&#x27;,

    //The primary port to listen for traffic on.  Some environment such as
    //heroku force you to use whatever port they have available.  In such cases
    //the port is passed as an environment variable.
	sitePort: process.env.port || process.env.PORT || 8080,

    //the absolute file path to the directory where installation lives
	docRoot:  Configuration.DOCUMENT_ROOT,

    //provides a configuration for connecting to persistent storage.  The
    //default configuration is meant for mongodb.
	db: {
        type:&#x27;mongo&#x27;,
		servers: [
          &#x27;127.0.0.1:27017&#x27;
        ],

        //the name of the default DB for the system
        name: &#x27;pencil_blue&#x27;,

        //http://docs.mongodb.org/manual/core/write-concern/
        writeConcern: 1,

        //PB provides the ability to log queries.  This is handy during
        //development to see how many trips to the DB a single request is
        //making.  The queries log at level &quot;info&quot;.
        query_logging: false,

        //http://mongodb.github.io/node-mongodb-native/api-generated/db.html#authenticate
        authentication: {
            un: null,
            pw: null,
            options: {
                //authMechanism: &quot;MONGODB-CR&quot;|&quot;GSSAPI&quot;|&quot;PLAIN&quot;, //Defaults to MONGODB-CR
                //authdb: &quot;db name here&quot;, //Defaults to the db attempted to be connected to
                //authSource: &quot;db name here&quot;, //Defaults to value of authdb
            }
        },

        //This option instructs the child to skip the checks to ensure that the
        //indices are built.  It makes the assumption that the user doesn&#x27;t care
        //or that they are already in place.  This would typically be used in a
        //large production system where load can burst.  In that particular case
        //you wouldn&#x27;t want to let your instances annoy the DB to check for
        //indices because it would cause greater strain on the DB under heavy
        //load.
        skip_index_check: false,

        //The indices that will be ensured by the system.  This list is checked
        //at startup by every child process.  The override config.json file may
        //also provide this attribute.  In that case the items in that array
        //will be added to the those that already exist.  NOTE: duplicates can
        //exist.
        indices: [

            //user
            {
                collection: &#x27;user&#x27;,
                spec: {username: ASC},
                options: {unique: true}
            },
            {
                collection: &#x27;user&#x27;,
                spec: {email: ASC},
                options: {unique: true}
            },
            {
                collection: &#x27;user&#x27;,
                spec: {username: ASC, password: ASC},
                options: {}
            },
            {
                collection: &#x27;user&#x27;,
                spec: {created: ASC},
                options: {}
            },
            {
                collection: &#x27;user&#x27;,
                spec: {admin: DESC},
                options: {}
            },
            
            //unverified user
            {
                collection: &#x27;unverified_user&#x27;,
                spec: { last_modified: ASC },
                options: { expireAfterSeconds: 2592000 }
            },

            //theme settings
            {
                collection: &#x27;theme_settings&#x27;,
                spec: {plugin_uid: ASC},
                options: {}
            },
            {
                collection: &#x27;theme_settings&#x27;,
                spec: {plugin_id: ASC},
                options: {}
            },

            //plugin settings
            {
                collection: &#x27;plugin_settings&#x27;,
                spec: {plugin_uid: ASC},
                options: {unique: true}
            },
            {
                collection: &#x27;plugin_settings&#x27;,
                spec: {plugin_id: ASC},
                options: {unique: true}
            },

            //settings
            {
                collection: &#x27;setting&#x27;,
                spec: {key: ASC},
                options: {unique: true}
            },

            //section
            {
                collection: &#x27;section&#x27;,
                spec: {parent: ASC},
                options: {}
            },
            {
                collection: &#x27;section&#x27;,
                spec: {created: ASC},
                options: {}
            },

            //plugin
            {
                collection: &#x27;plugin&#x27;,
                spec: {uid: ASC},
                options: {unique: true}
            },
            {
                collection: &#x27;plugin&#x27;,
                spec: {created: ASC},
                options: {}
            },

            //password reset
            {
                collection: &#x27;password_reset&#x27;,
                spec: {verification_code: ASC},
                options: {unique: true}
            },

            //media
            {
                collection: &#x27;media&#x27;,
                spec: {location: ASC},
                options: {}
            },
            {
                collection: &#x27;media&#x27;,
                spec: {name: ASC},
                options: {}//TODO make unique once validation is in place
            },
            {
                collection: &#x27;media&#x27;,
                spec: {media_type: ASC},
                options: {}//TODO make unique once validation is in place
            },
            {
                collection: &#x27;media&#x27;,
                spec: {created: ASC},
                options: {}
            },

            //job run
            //NOTHING YET

            //job log
            {
                collection: &#x27;job_log&#x27;,
                spec: {job_id: ASC},
                options: {}//TODO make unique once validation is in place
            },
            {
                collection: &#x27;job_log&#x27;,
                spec: {job_id: ASC, created: ASC},
                options: {}//TODO make unique once validation is in place
            },
            {
                collection: &#x27;job_log&#x27;,
                spec: {created: ASC},
                options: {}
            },

            //custom object type
            {
                collection: &#x27;custom_object_type&#x27;,
                spec: {name: ASC},
                options: {unique: true}
            },
            {
                collection: &#x27;custom_object_type&#x27;,
                spec: {created: ASC},
                options: {}
            },

            //custom objects
            {
                collection: &#x27;custom_object&#x27;,
                spec: {name: ASC, type: ASC},
                options: {unique: true}
            },
            {
                collection: &#x27;custom_object&#x27;,
                spec: {created: ASC},
                options: {}
            },

            //article
            {
                collection: &#x27;article&#x27;,
                spec: {url: ASC},
                options: {unique: true}
            },
            {
                collection: &#x27;article&#x27;,
                spec: {headline: ASC},
                options: {unique: true}
            },
            {
                collection: &#x27;article&#x27;,
                spec: {publish_date: DESC},
                options: {}
            },
            {
                collection: &#x27;article&#x27;,
                spec: {publish_date: DESC, draft: ASC},
                options: {}
            },
            {
                collection: &#x27;article&#x27;,
                spec: {author: ASC},
                options: {}
            },
            {
                collection: &#x27;article&#x27;,
                spec: {author: ASC, publish_date: DESC, draft: ASC},
                options: {}
            },
            {
                collection: &#x27;article&#x27;,
                spec: {article_media: ASC},
                options: {}
            },
            {
                collection: &#x27;article&#x27;,
                spec: {article_topics: ASC},
                options: {}
            },
            {
                collection: &#x27;article&#x27;,
                spec: {article_sections: ASC},
                options: {}
            },
            {
                collection: &#x27;article&#x27;,
                spec: {created: ASC},
                options: {}
            },

            //topic
            {
                collection: &#x27;topic&#x27;,
                spec: {name: ASC},
                options: {unique: true}
            },
            {
                collection: &#x27;topic&#x27;,
                spec: {created: ASC},
                options: {}
            },

            //page
            {
                collection: &#x27;page&#x27;,
                spec: {url: ASC},
                options: {unique: true}
            },
            {
                collection: &#x27;page&#x27;,
                spec: {headline: ASC},
                options: {unique: true}
            },
            {
                collection: &#x27;page&#x27;,
                spec: {publish_date: DESC},
                options: {}
            },
            {
                collection: &#x27;page&#x27;,
                spec: {publish_date: DESC, draft: ASC},
                options: {}
            },
            {
                collection: &#x27;page&#x27;,
                spec: {author: ASC},
                options: {}
            },
            {
                collection: &#x27;page&#x27;,
                spec: {author: ASC, publish_date: DESC, draft: ASC},
                options: {}
            },
            {
                collection: &#x27;page&#x27;,
                spec: {page_media: ASC},
                options: {}
            },
            {
                collection: &#x27;page&#x27;,
                spec: {page_topics: ASC},
                options: {}
            },
            {
                collection: &#x27;page&#x27;,
                spec: {created: ASC},
                options: {}
            }
        ]
	},

    //PB supports redis as a caching layer out of the box.  For development
    //purposes the &quot;fake-redis&quot; module can be used by setting the fake property
    //to true.
	cache: {
		fake: true,
		host: &quot;localhost&quot;,
		port: 6379,
        //auth_pass: &quot;password here&quot;
	},

    //PB supports two session stores out of the box: mongo &amp; redis.  The
    //timeout value is in ms.
	session: {
		storage: &quot;redis&quot;,
		timeout: 2000000
	},

    //The logging settings.  The level property specifies at what level to log.  
    //It can be of any of the following: silly, debug, info, warn, error.  The 
    //file property specifes the absolute file path where the log file should 
    //be written.  If no value is provided the file transport will not be 
    //configured.
    logging: {
        
        level: &quot;info&quot;,
        file: LOG_FILE
    },

    //System settings always have the persistent storage layer on.  Optionally,
    //the cache and/or memory can be used.  It is not recommended to use memory
    //unless you are developing locally with a single worker.  Memory is not
    //synced across cluster workers so be careful if this option is set to true.
	settings: {
		use_memory: true,
		use_cache: false,
        
        //The timeout specifies how long in milliseconds a setting will exist 
        //in memory before being flushed.  A value of 0 indicates that the 
        //values will not be purged from memory once expired.
        memory_timeout: 0,
	},

    //The template engine can take advantage of caching so that they are not
    //retrieved and compiled from disk on each request.  In a development
    //environment it is ok because you will want to see the changes you make
    //after each tweak.
	templates: {
		use_memory: true,
		use_cache: false,
        
        //The timeout specifies how long in milliseconds a setting will exist 
        //in memory before being flushed.  A value of 0 indicates that the 
        //values will not be purged from memory once expired.
        memory_timeout: 0,
	},

    //Plugins can also take advantage of the caching.  This prevents a DB call
    //to lookup active plugins and their settings.
	plugins: {
		caching: {
			use_memory: true,
			use_cache: false,
            
            //The timeout specifies how long in milliseconds a setting will exist 
            //in memory before being flushed.  A value of 0 indicates that the 
            //values will not be purged from memory once expired.
            memory_timeout: 0,
		}
	},

    //PB provides a process registry.  It utilizes the cache to register
    //properties about itself that are available via API or in the admin
    //console.  This makes it easy to assist in monitoring your cluster and
    //processes in production or development.  The type value can be one of
    //three values: &#x27;redis&#x27;, &#x27;mongo&#x27; or an absolute path that implements the
    //functions necessary to be a registration storage provider.The update
    //interval specifies how many ms to wait before updating the registry with
    //fresh data about itself.  The key specifies what the base of the cache
    //key looks like.
	registry: {
		enabled: true,
        logging_enabled: false,
        type: &quot;redis&quot;,
		update_interval: 10000,
		key: &#x27;server_registry&#x27;
	},

    //PB aims to help developers scale.  The system can take advantage of
    //Node&#x27;s cluster module to scale across the system cores. In order to
    //protect against repeated catastrophic failures the system allows for
    //&quot;fatal_error_count&quot; errors to occur outside of &quot;fatal_error_timeout&quot; secs.
    //If the maximum number of failures occur inside of the allowed timeframe
    //the master process and all the worker children will shutdown.
    cluster: {
        fatal_error_timeout: 2000,
        fatal_error_count: 5,
        
        //This value descibes the number of child processes to spawn when the 
        //master process is started in self managed mode.  The value can also 
        //be set to &quot;auto&quot;.  This will instruct the master process to inspect 
        //the number of cores on the server and spawn a child process for each 
        //core.
        workers: 1,
        
        //The self managed flag indicates whether or not PencilBlue should 
        //start a master process who&#x27;s sole responsibility is to watch over the 
        //child workers that it spawns.  The default, TRUE, allows for 
        //PencilBlue to watch for failures and decide on its own whether or not 
        //to attempt to continue.  When FALSE, PB starts as a stand alone 
        //process.  Set to FALSE when you want to debug a single process or 
        //when operating in a cloud environment that manages the instances on 
        //each server.
        self_managed: true
    },

    //PB supports two methods of handling SSL.  Standard point to a cert as
    //described by the options below and SSL termination and the use of the
    //&quot;X-FORWARDED-PROTO&quot; header.  Node does not gracefully handle the redirect
    //of HTTP traffic to HTTPS.  PB handles this for you in what we call the
    //handoff.  PB will start a second http server listening on the
    //&quot;handoff_port&quot;.  When traffic is received it will be redirected to the
    //URL of the form &quot;siteRoot+[URL PATH]&quot;.  The port will only show if
    //specified by the &quot;use_handoff_port_in_redirect&quot; property.
    server: {
        ssl: {
            enabled: false,
            handoff_port: 8080,
            use_x_forwarded: false,
            use_handoff_port_in_redirect: false,
            key: &quot;ssl/key.pem&quot;,
            cert: &quot;ssl/cert.crt&quot;,
            chain: &quot;ssl/chain.crt&quot;
        },

        //when non-empty, a header (X-POWERED-BY) will be added to each outgoing
        //response with &quot;PencilBlue&quot;.  Cheesy but it helps the BuiltWith tools
        //of the world kep track of who uses what
        x_powered_by: &quot;PencilBlue&quot;
    },

    //PB uses a publish subscribe model to announce events to other members of
    //the cluster.  Out of the box PB provides a Redis implementation but it is
    //also possible to provide a custom implementation. AMQP would be a good
    //future implementation just as an example.  Custom implementations can be
    //used by providing the absolute path to the implementation in the &quot;broker&quot;
    //field.
    command: {
        broker: &#x27;redis&#x27;,
        timeout: 3000
    },

    //The media block specifies the options for how media is persisted.  
    //PencilBlue provides two storage engines out of the box.  The first is 
    //&#x27;fs&#x27; which is the regular file system.  This is the default option.  
    //However, as soon as PB is clustered on two or more nodes this **MUST** be 
    //changed to a different provider.  The second provider, &#x27;mongo&#x27;, is a media 
    //storage mechanism powered by MongoDB&#x27;s GridFS.  The &#x27;mongo&#x27; provider does 
    //support the distributed PencilBlue configuration although it is not 
    //recommended for large scale use.  Systems that have larger or more 
    //performant data needs should look at other plugins to support that need.
    media: {

        provider: &#x27;fs&#x27;,
        parent_dir: &#x27;public&#x27;,
        
        //The maximum size of media files that can be uploaded to the server in 
        //bytes
        max_upload_size: 2 * 1024 * 1024
    },
    
    //Pulls in the package.json file for PB and extracts the version so it is 
    //available in the configuration.
    version: require(path.join(Configuration.DOCUMENT_ROOT, &#x27;package.json&#x27;)).version
};

/** 
 * Retrieve the base configuration
 */
Configuration.getBaseConfig = function() {
    return util.clone(BASE_CONFIG);
};

/**
 * Loads an external configuration.
 * NOTE: This should only be called once by the core code at startup.  Calling
 * this function after the server starts may cause unintended behavior across
 * the system.
 */
Configuration.load = function(filePaths) {
    if (util.isString(filePaths)) {
        filePaths = [filePaths];
    }
    else if (!filePaths) {
        filePaths = OVERRIDE_FILE_PATHS;
    }

    //find the override file, if exists
    var override       = {};
    var overrideFile   = null;
    var overridesFound = false;
    for (var i = 0; i &lt; filePaths.length; i++) {

    	overrideFile = filePaths[i];
    	if (fs.existsSync(overrideFile)) {

            try{
                override       = require(overrideFile);
                overridesFound = true;
                break;
            }
            catch(e){
                console.log(&#x27;SystemStartup: Failed to parse configuration file [%s]: %s&#x27;, overrideFile, e.stack);
            }
    	}
    }

    //log result
    var message;
    if (overridesFound) {
        message = util.format(&#x27;Override file [%s] will be applied.&#x27;, overrideFile);
    }
    else {
        message = &#x27;No overrides are available, skipping to defaults after searching the following files:&#x27;;
        filePaths.forEach(function(filePath) {
            message += util.format(&#x27;\n* %s&#x27;, filePath);
        });
    }
    console.log(message);

    //perform any overrides
    return Configuration.mergeWithBase(override);
};

/**
 * 
 * @static
 * @method mergeWithBase
 */
Configuration.mergeWithBase = function(overrides) {
    
    //merge in all overrides with the base configuration
    var config = util.deepMerge(overrides, Configuration.getBaseConfig());

    //special check to ensure that there is no ending slash on the site root
    if (config.siteRoot.lastIndexOf(&#x27;/&#x27;) === (config.siteRoot.length - 1)) {
        config.siteRoot = config.siteRoot.substring(0, config.siteRoot.length - 1);
    }
    
	return config;
};

//export configuration
module.exports = Configuration;

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
